<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tate Academy - Deviate DC 2026</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Leaflet CSS & JS for Interactive Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        body {
            font-family: 'Outfit', sans-serif;
            background-color: #f8fafc;
            color: #1a1b1d;
        }

        /* Tate Academy Colors */
        :root {
            --tate-pink: #d5164d;
            --tate-dark: #1a1b1d;
            --tate-pink-light: #f9e0e6;
            --tate-pink-100: #fce8ed;
            --tate-pink-200: #f8c5d1;
            --tate-pink-300: #f1a3b5;
            --tate-pink-400: #e8708d;
            --tate-pink-500: #d5164d;
            --tate-pink-600: #b81343;
            --tate-pink-700: #9a1039;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(4px);
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .tab-btn {
            transition: all 0.2s ease;
        }

        .tab-btn.active {
            background: var(--tate-pink);
            color: white;
        }

        .cal-btn {
            transition: all 0.2s ease;
        }

        .cal-btn:hover {
            transform: translateY(-1px);
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .division-junior { background: #fef3c7; color: #92400e; }
        .division-preteen { background: #dbeafe; color: #1e40af; }
        .division-teen { background: #dcfce7; color: #166534; }
        .division-senior { background: #fce7f3; color: #9d174d; }

        .type-solo { background: #fecaca; color: #991b1b; }
        .type-group { background: #bfdbfe; color: #1e40af; }
        .type-line { background: #c7d2fe; color: #3730a3; }
        .type-production { background: #ddd6fe; color: #5b21b6; }
        .type-trio { background: #fbcfe8; color: #9d174d; }

        .add-cal-btn {
            background: var(--tate-pink-100);
            color: var(--tate-pink-600);
            transition: all 0.2s ease;
        }
        .add-cal-btn:hover {
            background: var(--tate-pink-200);
            color: var(--tate-pink-700);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="text-white sticky top-0 z-50 shadow-lg" style="background: linear-gradient(135deg, #d5164d, #9a1039);">
        <div class="max-w-4xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold tracking-tight">Tate Academy Company</h1>
                    <p class="text-pink-200 text-sm">Deviate (The Process) - Herndon, VA</p>
                    <p class="text-pink-300 text-xs mt-1">February 13-15, 2026</p>
                </div>
                <div id="clock" class="text-sm font-semibold bg-white/20 px-3 py-1 rounded-full"></div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <nav class="max-w-4xl mx-auto px-2 pb-2 flex space-x-1 overflow-x-auto" id="nav-container"></nav>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-4xl mx-auto w-full p-4">
        <div id="content-container"></div>
    </main>

    <!-- Footer -->
    <footer class="py-4 mt-8" style="background: #1a1b1d;">
        <div class="max-w-4xl mx-auto px-4 text-center">
            <p class="text-xs text-gray-400">Tate Academy Company - Deviate 2026 | Herndon, VA</p>
            <p class="text-xs mt-1" style="color: #d5164d;">Go Team!</p>
        </div>
    </footer>

    <script>
        // --- State Management ---
        const state = {
            currentTab: 'schedule',
            ageFilter: 'all',
            expandedGroups: {} // Track which schedule groups are expanded
        };

        // Toggle accordion section
        function toggleScheduleGroup(groupKey) {
            state.expandedGroups[groupKey] = !state.expandedGroups[groupKey];
            const content = document.getElementById(`schedule-content-${groupKey}`);
            const arrow = document.getElementById(`schedule-arrow-${groupKey}`);
            if (content && arrow) {
                if (state.expandedGroups[groupKey]) {
                    content.style.maxHeight = content.scrollHeight + 'px';
                    arrow.style.transform = 'rotate(180deg)';
                } else {
                    content.style.maxHeight = '0';
                    arrow.style.transform = 'rotate(0deg)';
                }
            }
        }

        // --- Event Information ---
        const eventInfo = {
            name: "Deviate (The Process)",
            location: "Herndon, VA",
            dates: "February 13-15, 2026",
            venue: "Hyatt Regency Dulles",
            venueAddress: "2300 Dulles Corner Blvd, Herndon, VA 20171",
            venueLat: 38.9565,
            venueLng: -77.4089
        };

        // --- Convention Schedule by Age Group ---
        const conventionByAgeGroup = {
            teensSeniors: {
                name: "Teens/Seniors",
                ages: "Ages 13 & Up",
                room: "Luray Ballroom",
                color: "pink",
                saturday: [
                    { time: "7:15 AM", end: "7:45 AM", name: "Registration" },
                    { time: "7:45 AM", end: "8:00 AM", name: "Welcome" },
                    { time: "8:00 AM", end: "9:00 AM", name: "Musical Theatre" },
                    { time: "9:05 AM", end: "10:05 AM", name: "Ballet" },
                    { time: "10:10 AM", end: "11:10 AM", name: "Tap" },
                    { time: "11:10 AM", end: "12:00 PM", name: "Lunch", isBreak: true },
                    { time: "12:00 PM", end: "1:00 PM", name: "Hip Hop" },
                    { time: "1:05 PM", end: "2:05 PM", name: "Lyrical" },
                    { time: "2:30 PM", end: "6:30 PM", name: "Sr. Audition Lab (Ages 15 & Up)", note: "Ages 15+" },
                    { time: "2:30 PM", end: "6:30 PM", name: "Teen Audition Lab (Ages 12-14)", note: "In Jr. Ballroom" },
                    { time: "7:00 PM", end: "7:00 PM", name: "Standouts Announced", note: "In Sr. Ballroom" },
                    { time: "7:00 PM", end: "8:00 PM", name: "Standout Rehearsal" }
                ],
                sunday: [
                    { time: "7:30 AM", end: "9:30 AM", name: "Standout Rehearsal", note: "Sr. Ballroom" },
                    { time: "9:35 AM", end: "10:35 AM", name: "Industry Class" },
                    { time: "10:45 AM", end: "11:45 AM", name: "Jazz" },
                    { time: "11:50 AM", end: "12:50 PM", name: "Contemporary" },
                    { time: "12:50 PM", end: "1:50 PM", name: "Lunch", isBreak: true },
                    { time: "1:50 PM", end: "3:10 PM", name: "Showcase Rehearsal" },
                    { time: "3:15 PM", end: "3:15 PM", name: "Doors Open" },
                    { time: "3:30 PM", end: "5:00 PM", name: "Showcase" }
                ]
            },
            juniors: {
                name: "Juniors",
                ages: "Ages 9-12",
                room: "Cirrus Ballroom",
                color: "yellow",
                saturday: [
                    { time: "7:15 AM", end: "7:45 AM", name: "Registration" },
                    { time: "7:45 AM", end: "8:00 AM", name: "Welcome", note: "In Sr. Ballroom" },
                    { time: "8:00 AM", end: "9:00 AM", name: "Hip Hop" },
                    { time: "9:05 AM", end: "10:05 AM", name: "Lyrical" },
                    { time: "10:10 AM", end: "11:10 AM", name: "Ballet" },
                    { time: "11:10 AM", end: "12:00 PM", name: "Lunch", isBreak: true },
                    { time: "12:00 PM", end: "1:00 PM", name: "Jazz" },
                    { time: "1:05 PM", end: "2:05 PM", name: "Contemporary" },
                    { time: "2:30 PM", end: "6:30 PM", name: "Teen Audition Lab (Ages 12-14)", note: "In Jr. Ballroom" },
                    { time: "7:00 PM", end: "7:00 PM", name: "Standouts Announced", note: "In Sr. Ballroom" },
                    { time: "7:00 PM", end: "8:00 PM", name: "Standout Rehearsal", note: "Teens/Seniors - Sr. Ballroom" }
                ],
                sunday: [
                    { time: "7:30 AM", end: "9:30 AM", name: "Standout Rehearsal", note: "Teens/Seniors - Sr. Ballroom" },
                    { time: "8:00 AM", end: "10:30 AM", name: "Junior Audition Lab (Ages 9-11)", note: "In Jr. Ballroom" },
                    { time: "10:45 AM", end: "11:45 AM", name: "Tap" },
                    { time: "11:50 AM", end: "12:50 PM", name: "Musical Theatre" },
                    { time: "12:50 PM", end: "1:50 PM", name: "Lunch", isBreak: true },
                    { time: "1:50 PM", end: "3:10 PM", name: "Showcase Rehearsal" },
                    { time: "3:15 PM", end: "3:15 PM", name: "Doors Open" },
                    { time: "3:30 PM", end: "5:00 PM", name: "Showcase", note: "Sr. Ballroom" }
                ]
            },
            minis: {
                name: "Minis",
                ages: "Ages 6-8",
                room: "Layton",
                color: "blue",
                saturday: [
                    { time: "7:15 AM", end: "7:45 AM", name: "Registration" },
                    { time: "7:45 AM", end: "8:00 AM", name: "Welcome", note: "In Sr. Ballroom" },
                    { time: "8:00 AM", end: "9:00 AM", name: "Jazz" },
                    { time: "9:05 AM", end: "10:05 AM", name: "Musical Theatre" },
                    { time: "10:10 AM", end: "11:10 AM", name: "Contemporary" },
                    { time: "11:10 AM", end: "12:00 PM", name: "Lunch", isBreak: true },
                    { time: "12:00 PM", end: "1:00 PM", name: "Mini Mania" }
                ],
                sunday: [
                    { time: "9:30 AM", end: "10:30 AM", name: "Mini Mania" },
                    { time: "10:45 AM", end: "11:45 AM", name: "Lyrical" },
                    { time: "11:50 AM", end: "12:50 PM", name: "Hip Hop" },
                    { time: "12:50 PM", end: "1:50 PM", name: "Lunch", isBreak: true },
                    { time: "1:50 PM", end: "3:10 PM", name: "Showcase Rehearsal" },
                    { time: "3:15 PM", end: "3:15 PM", name: "Doors Open" },
                    { time: "3:30 PM", end: "5:00 PM", name: "Showcase", note: "Sr. Ballroom" }
                ]
            },
            parents: {
                name: "Teachers & Parents",
                ages: "",
                room: "Rockbridge Ballroom",
                color: "green",
                saturday: [
                    { time: "8:00 AM", end: "1:00 PM", name: "Studio Director/Teacher Feedback Sessions", note: "*Sign Up On Site*" },
                    { time: "1:05 PM", end: "2:05 PM", name: "Parent Teacher Jazz Class" }
                ],
                sunday: [
                    { time: "8:30 AM", end: "9:30 AM", name: "Parent Teacher Theatre Jazz Class" },
                    { time: "9:35 AM", end: "12:50 PM", name: "Studio Director/Teacher Feedback Sessions", note: "*Sign Up On Site*" }
                ]
            }
        };

        // --- Competition Dance Order (Friday 2/13/26) ---
        const danceOrder = [
            { num: 1, time: "9:00 AM", name: "Raspberry Beret", dancer: "Bella", division: "Junior", style: "Jazz", type: "Solo" },
            { num: 4, time: "9:08 AM", name: "Le Freak", dancer: "Anaya", division: "Junior", style: "Jazz", type: "Solo" },
            { num: 7, time: "9:16 AM", name: "Wings", dancer: "Liana", division: "", style: "", type: "Solo" },
            { num: 22, time: "10:00 AM", name: "Slow It Down", dancer: "Ella B", division: "", style: "", type: "Solo" },
            { num: 25, time: "10:08 AM", name: "Work Me", dancer: "", division: "", style: "", type: "Group" },
            { num: 30, time: "10:23 AM", name: "Just Like A River Does", dancer: "", division: "", style: "", type: "Group" },
            { num: 34, time: "10:37 AM", name: "Fly", dancer: "", division: "", style: "", type: "Group" },
            { num: 41, time: "11:00 AM", name: "White Rabbit", dancer: "Teen Contemporary", division: "Teen", style: "Contemporary", type: "Group" },
            { num: 47, time: "11:19 AM", name: "Know About Me", dancer: "", division: "", style: "", type: "Group" },
            { num: 48, time: "11:55 AM", name: "The Way", dancer: "Teen Jazz", division: "Teen", style: "Jazz", type: "Group" },
            { num: 53, time: "12:09 PM", name: "What The World Need Now", dancer: "Teen Trio", division: "Teen", style: "Lyrical", type: "Trio" },
            { num: 59, time: "12:28 PM", name: "Hairspray", dancer: "Mini/Teen Jazz", division: "Mini/Teen", style: "Jazz", type: "Group" },
            { num: null, time: "1:00 PM", name: "Awards 6-12", dancer: "", division: "", style: "", type: "Awards", isAwards: true },
            { num: 64, time: "1:48 PM", name: "Corps", dancer: "Camilla", division: "Teen", style: "", type: "Solo" },
            { num: 73, time: "2:16 PM", name: "Other Side", dancer: "Carly", division: "Teen", style: "Contemporary", type: "Solo" },
            { num: 74, time: "2:19 PM", name: "When I Go", dancer: "Robbie", division: "PreTeen", style: "Contemporary", type: "Solo" },
            { num: 82, time: "2:43 PM", name: "I Dreamed A Dream", dancer: "Zoe", division: "PreTeen", style: "Lyrical", type: "Solo" },
            { num: 83, time: "2:46 PM", name: "River", dancer: "Eden", division: "PreTeen", style: "Lyrical", type: "Solo" },
            { num: 108, time: "4:20 PM", name: "Winner Takes It All", dancer: "Lula", division: "Senior", style: "Contemporary", type: "Solo" },
            { num: 110, time: "4:26 PM", name: "These Arms Of Mine", dancer: "Chloe", division: "Senior", style: "Contemporary", type: "Solo" },
            { num: 115, time: "4:42 PM", name: "Out There", dancer: "Alina", division: "Senior", style: "Contemporary", type: "Solo" },
            { num: 123, time: "5:08 PM", name: "Dead & Done", dancer: "Contemporary", division: "Senior", style: "Contemporary", type: "Group" },
            { num: 136, time: "5:57 PM", name: "Tennessee Whiskey", dancer: "Liam", division: "Senior", style: "Contemporary", type: "Solo" },
            { num: 146, time: "6:34 PM", name: "Cry To Me", dancer: "Jazz", division: "Senior", style: "Jazz", type: "Group" },
            { num: 150, time: "6:48 PM", name: "End Of Love", dancer: "Lyrical", division: "Senior", style: "Lyrical", type: "Line" },
            { num: 152, time: "7:30 PM", name: "Golden Years", dancer: "Production", division: "Teen", style: "Jazz", type: "Production" },
            { num: 156, time: "7:48 PM", name: "Dreams", dancer: "Ella G.", division: "Senior", style: "Jazz", type: "Solo" },
            { num: 164, time: "8:16 PM", name: "Foolish Games", dancer: "Talia G.", division: "Senior", style: "Lyrical", type: "Solo" },
            { num: 166, time: "8:22 PM", name: "One More Second", dancer: "Talya B.", division: "Senior", style: "Lyrical", type: "Solo" },
            { num: 170, time: "8:35 PM", name: "Lose Yourself", dancer: "Riley", division: "Senior", style: "Hip Hop", type: "Solo" },
            { num: 175, time: "8:50 PM", name: "Cellophane", dancer: "Lyrical", division: "Senior", style: "Lyrical", type: "Group" },
            { num: 179, time: "9:02 PM", name: "Kendrick", dancer: "Hip Hop", division: "Senior", style: "Hip Hop", type: "Group" },
            { num: null, time: "9:40 PM", name: "Awards 13+", dancer: "", division: "", style: "", type: "Awards", isAwards: true }
        ];

        // --- Places to Eat (Near Hyatt Regency Dulles, Herndon VA) ---
        const placesToEat = {
            walkable: [
                { name: "Chili's Grill & Bar", type: "American", distance: "0.1 mi", address: "2250 Centreville Rd, Herndon", price: "$$", lat: 38.9575, lng: -77.4070, note: "Right next to hotel, kid-friendly", website: "https://www.chilis.com", menu: "https://www.chilis.com/menu" },
                { name: "Olive Garden", type: "Italian", distance: "0.2 mi", address: "2285 Centreville Rd, Herndon", price: "$$", lat: 38.9580, lng: -77.4065, note: "Pasta, breadsticks, familiar favorites", website: "https://www.olivegarden.com", menu: "https://www.olivegarden.com/menu" },
                { name: "Red Robin", type: "Burgers", distance: "0.3 mi", address: "2200 Centreville Rd, Herndon", price: "$$", lat: 38.9560, lng: -77.4075, note: "Great burgers, bottomless fries", website: "https://www.redrobin.com", menu: "https://www.redrobin.com/menu" },
                { name: "Founding Farmers", type: "American Farm-to-Table", distance: "1.5 mi", address: "1800 Tysons Blvd, Tysons", price: "$$$", lat: 38.9180, lng: -77.2230, note: "Upscale, great brunch (short drive)", website: "https://www.wearefoundingfarmers.com/location/tysons", menu: "https://www.wearefoundingfarmers.com/location/tysons/menu" },
                { name: "Pho 75", type: "Vietnamese", distance: "1.2 mi", address: "382 Elden St, Herndon", price: "$", lat: 38.9690, lng: -77.3920, note: "Authentic pho, quick & delicious", website: null, menu: null },
                { name: "Paisano's Pizza", type: "Pizza/Italian", distance: "1.0 mi", address: "2456 Centreville Rd, Herndon", price: "$$", lat: 38.9620, lng: -77.4050, note: "Great pizza, delivers!", website: "https://www.paisanospizza.com", menu: "https://www.paisanospizza.com/menu" },
                { name: "Jimmy John's", type: "Sandwiches", distance: "0.5 mi", address: "13324 Franklin Farm Rd, Herndon", price: "$", lat: 38.9550, lng: -77.4020, note: "Fast subs, good for quick lunch", website: "https://www.jimmyjohns.com", menu: "https://www.jimmyjohns.com/menu" }
            ],
            delivery: [
                { name: "Domino's Pizza", type: "Pizza", phone: "(703) 471-7400", apps: ["DoorDash", "UberEats", "Domino's App"], website: "https://www.dominos.com", menu: "https://www.dominos.com/en/pages/order" },
                { name: "Chipotle", type: "Mexican", phone: "", apps: ["DoorDash", "UberEats", "Chipotle App"], website: "https://www.chipotle.com", menu: "https://www.chipotle.com/order" },
                { name: "Sweetgreen", type: "Salads/Bowls", phone: "", apps: ["DoorDash", "Sweetgreen App"], website: "https://www.sweetgreen.com", menu: "https://order.sweetgreen.com" },
                { name: "CAVA", type: "Mediterranean", phone: "", apps: ["DoorDash", "UberEats", "CAVA App"], website: "https://www.cava.com", menu: "https://order.cava.com" },
                { name: "Chick-fil-A", type: "Chicken", phone: "", apps: ["DoorDash", "UberEats", "CFA App"], website: "https://www.chick-fil-a.com", menu: "https://www.chick-fil-a.com/menu" },
                { name: "Panera Bread", type: "Bakery/Soup/Salad", phone: "", apps: ["DoorDash", "Panera App"], website: "https://www.panerabread.com", menu: "https://www.panerabread.com/en-us/menu.html" },
                { name: "Jersey Mike's", type: "Subs", phone: "", apps: ["DoorDash", "UberEats", "Jersey Mike's App"], website: "https://www.jerseymikes.com", menu: "https://www.jerseymikes.com/menu" },
                { name: "Nando's Peri-Peri", type: "Chicken", phone: "", apps: ["DoorDash", "UberEats"], website: "https://www.nandosperiperi.com", menu: "https://www.nandosperiperi.com/food/menu" }
            ]
        };

        // --- Nearby Activities ---
        const nearbyActivities = [
            { name: "Udvar-Hazy Air & Space Museum", type: "Museum", distance: "3 mi", address: "14390 Air and Space Museum Pkwy, Chantilly", note: "FREE! Space Shuttle Discovery, SR-71 Blackbird, WWII planes. MUST SEE!", icon: "üöÄ", lat: 38.9114, lng: -77.4440, website: "https://airandspace.si.edu/udvar-hazy-center" },
            { name: "Reston Town Center", type: "Shopping/Dining", distance: "4 mi", address: "11900 Market St, Reston", note: "Outdoor shopping, restaurants, ice skating rink, movie theater.", icon: "üõçÔ∏è", lat: 38.9586, lng: -77.3590, website: "https://www.restontowncenter.com" },
            { name: "Frying Pan Farm Park", type: "Farm/Nature", distance: "5 mi", address: "2709 West Ox Rd, Herndon", note: "FREE! Working farm, animals, playground. Great for younger kids.", icon: "üêÑ", lat: 38.9290, lng: -77.3510, website: "https://www.fairfaxcounty.gov/parks/frying-pan-park" },
            { name: "Dulles Town Center", type: "Mall", distance: "2 mi", address: "21100 Dulles Town Cir, Dulles", note: "Large indoor mall with all the stores. Good rainy day option.", icon: "üè¨", lat: 38.9880, lng: -77.4190, website: "https://www.dullestowncenter.com" },
            { name: "TopGolf", type: "Entertainment", distance: "8 mi", address: "6625 S Van Dorn St, Alexandria", note: "Fun golf games, food, arcade. Great for teens!", icon: "‚õ≥", lat: 38.7960, lng: -77.1290, website: "https://topgolf.com/us/alexandria" },
            { name: "Dave & Buster's", type: "Entertainment", distance: "5 mi", address: "8300 Westpark Dr, Tysons", note: "Arcade games, food, prizes. Perfect for downtime!", icon: "üéÆ", lat: 38.9210, lng: -77.2320, website: "https://www.daveandbusters.com" },
            { name: "Historic Downtown Herndon", type: "Town", distance: "3 mi", address: "Downtown Herndon", note: "Cute small town feel, local shops, W&OD Trail access.", icon: "üèòÔ∏è", lat: 38.9696, lng: -77.3867, website: "https://www.herndon-va.gov" },
            { name: "Great Falls Park", type: "Nature", distance: "12 mi", address: "9200 Old Dominion Dr, McLean", note: "Stunning waterfalls on the Potomac. $20/car entry. Worth the drive!", icon: "üåä", lat: 38.9985, lng: -77.2540, website: "https://www.nps.gov/grfa" }
        ];

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderClock();
            renderTabs();
            switchTab('schedule');
            setInterval(renderClock, 60000);
        });

        // --- Functions ---
        function renderClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            document.getElementById('clock').textContent = timeString;
        }

        function renderTabs() {
            const tabs = [
                { id: 'schedule', label: 'üìÖ Schedule' },
                { id: 'dances', label: 'üé≠ Dance Order' },
                { id: 'food', label: 'üçΩÔ∏è Places to Eat' },
                { id: 'activities', label: 'üó∫Ô∏è Things to Do' },
                { id: 'feedback', label: 'üí¨ Suggest Updates' }
            ];

            const nav = document.getElementById('nav-container');
            nav.innerHTML = '';

            tabs.forEach(tab => {
                const btn = document.createElement('button');
                btn.className = `tab-btn flex-shrink-0 px-4 py-2 text-sm font-medium rounded-lg ${state.currentTab === tab.id ? 'active' : 'bg-white/20 text-white hover:bg-white/30'}`;
                btn.textContent = tab.label;
                btn.onclick = () => switchTab(tab.id);
                nav.appendChild(btn);
            });
        }

        function switchTab(tabId) {
            state.currentTab = tabId;
            renderTabs();

            const container = document.getElementById('content-container');

            switch(tabId) {
                case 'schedule':
                    renderSchedule(container);
                    break;
                case 'dances':
                    renderDanceOrder(container);
                    break;
                case 'food':
                    renderFood(container);
                    break;
                case 'activities':
                    renderActivities(container);
                    break;
                case 'feedback':
                    renderFeedback(container);
                    break;
            }
        }

        // --- Generate Google Calendar Link ---
        function parseTime(timeStr) {
            // Parse time like "7:15 AM" to { hour: 7, minute: 15 }
            const match = timeStr.match(/(\d{1,2}):?(\d{2})?\s*(AM|PM)?/i);
            if (!match) return null;
            let hour = parseInt(match[1]);
            const minute = parseInt(match[2] || '0');
            const period = match[3]?.toUpperCase();

            if (period === 'PM' && hour !== 12) hour += 12;
            if (period === 'AM' && hour === 12) hour = 0;

            return { hour, minute };
        }

        function formatICSDate(dateStr, timeStr) {
            const t = parseTime(timeStr);
            if (!t) return '';
            // Parse the date string manually to avoid timezone issues
            const [year, month, day] = dateStr.split('-').map(Number);
            // Format: YYYYMMDDTHHMMSS
            const monthStr = String(month).padStart(2, '0');
            const dayStr = String(day).padStart(2, '0');
            const hourStr = String(t.hour).padStart(2, '0');
            const minStr = String(t.minute).padStart(2, '0');
            return `${year}${monthStr}${dayStr}T${hourStr}${minStr}00`;
        }

        function generateUID() {
            return 'deviate-' + Math.random().toString(36).substr(2, 9) + '@tateacademy';
        }

        function formatGoogleCalendarDate(dateStr, timeStr) {
            const t = parseTime(timeStr);
            if (!t) return '';
            // Parse the date string manually to avoid timezone issues
            const [year, month, day] = dateStr.split('-').map(Number);
            // Format: YYYYMMDDTHHMMSS (local time, no Z suffix)
            const monthStr = String(month).padStart(2, '0');
            const dayStr = String(day).padStart(2, '0');
            const hourStr = String(t.hour).padStart(2, '0');
            const minStr = String(t.minute).padStart(2, '0');
            return `${year}${monthStr}${dayStr}T${hourStr}${minStr}00`;
        }

        function generateGoogleCalendarLink(title, dateStr, startTime, endTime, room) {
            const eventTitle = encodeURIComponent(`Deviate: ${title}`);
            const location = encodeURIComponent(`${room}, ${eventInfo.venue}, ${eventInfo.venueAddress}`);
            const details = encodeURIComponent(`Tate Academy - Deviate Convention 2026`);

            const startDate = formatGoogleCalendarDate(dateStr, startTime);
            const endDate = formatGoogleCalendarDate(dateStr, endTime || startTime);

            return `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${eventTitle}&dates=${startDate}/${endDate}&location=${location}&details=${details}`;
        }

        function addSingleEventToCalendar(title, dateStr, startTime, endTime, room) {
            const link = generateGoogleCalendarLink(title, dateStr, startTime, endTime, room);
            window.open(link, '_blank');
        }

        function generateDanceOrderICS() {
            let icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Tate Academy//Deviate DC 2026//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
X-WR-CALNAME:Deviate - Competition Friday
X-WR-TIMEZONE:America/New_York
`;

            const location = `${eventInfo.venue}, ${eventInfo.venueAddress}`;

            danceOrder.forEach(dance => {
                if (dance.isAwards) return; // Skip awards for ICS

                const startDate = formatICSDate('2026-02-13', dance.time);
                // Estimate 3 minutes per performance
                const t = parseTime(dance.time);
                if (!t) return;
                const endDate = formatICSDate('2026-02-13', addMinutesToTime(dance.time, 3));
                const uid = generateUID();

                const title = dance.dancer
                    ? `${dance.name} - ${dance.dancer}`
                    : dance.name;
                const description = [
                    `Tate Academy - Deviate Competition`,
                    dance.dancer ? `Dancer: ${dance.dancer}` : '',
                    dance.division ? `Division: ${dance.division}` : '',
                    dance.style ? `Style: ${dance.style}` : '',
                    dance.type ? `Type: ${dance.type}` : '',
                    dance.num ? `Entry #${dance.num}` : ''
                ].filter(Boolean).join('\\n');

                icsContent += `BEGIN:VEVENT
UID:${uid}
DTSTART:${startDate}
DTEND:${endDate}
SUMMARY:${title}
LOCATION:${location}
DESCRIPTION:${description}
STATUS:CONFIRMED
END:VEVENT
`;
            });

            icsContent += `END:VCALENDAR`;

            // Create and download the file
            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `Deviate_Competition_Friday.ics`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        }

        function addMinutesToTime(timeStr, minutes) {
            const t = parseTime(timeStr);
            if (!t) return timeStr;
            let hour = t.hour;
            let minute = t.minute + minutes;
            if (minute >= 60) {
                hour += Math.floor(minute / 60);
                minute = minute % 60;
            }
            const period = hour >= 12 ? 'PM' : 'AM';
            const displayHour = hour > 12 ? hour - 12 : (hour === 0 ? 12 : hour);
            return `${displayHour}:${String(minute).padStart(2, '0')} ${period}`;
        }

        function addDanceToCalendar(name, dancer, time, division, style, type, num) {
            const title = dancer ? `${name} - ${dancer}` : name;
            const eventTitle = encodeURIComponent(`Deviate: ${title}`);
            const location = encodeURIComponent(`${eventInfo.venue}, ${eventInfo.venueAddress}`);

            const descParts = [
                `Tate Academy - Deviate Competition`,
                dancer ? `Dancer: ${dancer}` : '',
                division ? `Division: ${division}` : '',
                style ? `Style: ${style}` : '',
                type ? `Type: ${type}` : '',
                num ? `Entry #${num}` : ''
            ].filter(Boolean).join('\n');
            const details = encodeURIComponent(descParts);

            const startDate = formatGoogleCalendarDate('2026-02-13', time);
            const endTime = addMinutesToTime(time, 3);
            const endDate = formatGoogleCalendarDate('2026-02-13', endTime);

            const link = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${eventTitle}&dates=${startDate}/${endDate}&location=${location}&details=${details}`;
            window.open(link, '_blank');
        }

        function generateICSFile(groupKey) {
            const group = conventionByAgeGroup[groupKey];
            if (!group) return;

            let icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Tate Academy//Deviate DC 2026//EN
CALSCALE:GREGORIAN
METHOD:PUBLISH
X-WR-CALNAME:Deviate - ${group.name}
X-WR-TIMEZONE:America/New_York
`;

            const location = `${group.room}, ${eventInfo.venue}, ${eventInfo.venueAddress}`;

            // Add Saturday events
            group.saturday.forEach(cls => {
                if (cls.isBreak) return; // Skip lunch breaks

                const startDate = formatICSDate('2026-02-14', cls.time);
                const endDate = formatICSDate('2026-02-14', cls.end || cls.time);
                const uid = generateUID();

                icsContent += `BEGIN:VEVENT
UID:${uid}
DTSTART:${startDate}
DTEND:${endDate}
SUMMARY:${cls.name}${cls.note ? ' (' + cls.note + ')' : ''}
LOCATION:${location}
DESCRIPTION:Deviate Convention - ${group.name} ${group.ages}\\n${group.room}${cls.note ? '\\n' + cls.note : ''}
STATUS:CONFIRMED
END:VEVENT
`;
            });

            // Add Sunday events
            group.sunday.forEach(cls => {
                if (cls.isBreak) return; // Skip lunch breaks

                const startDate = formatICSDate('2026-02-15', cls.time);
                const endDate = formatICSDate('2026-02-15', cls.end || cls.time);
                const uid = generateUID();

                icsContent += `BEGIN:VEVENT
UID:${uid}
DTSTART:${startDate}
DTEND:${endDate}
SUMMARY:${cls.name}${cls.note ? ' (' + cls.note + ')' : ''}
LOCATION:${location}
DESCRIPTION:Deviate Convention - ${group.name} ${group.ages}\\n${group.room}${cls.note ? '\\n' + cls.note : ''}
STATUS:CONFIRMED
END:VEVENT
`;
            });

            icsContent += `END:VCALENDAR`;

            // Create and download the file
            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `Deviate_${group.name.replace(/[^a-zA-Z0-9]/g, '_')}_Schedule.ics`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        }

        // --- Render Schedule ---
        function renderSchedule(container) {
            // Tate Academy color shades for age groups
            const colorMap = {
                pink: { bgStyle: 'background:#d5164d', lightStyle: 'background:#fce8ed', borderStyle: 'border-color:#f8c5d1', textStyle: 'color:#d5164d' },
                yellow: { bgStyle: 'background:#e8708d', lightStyle: 'background:#fce8ed', borderStyle: 'border-color:#f8c5d1', textStyle: 'color:#b81343' },
                blue: { bgStyle: 'background:#f1a3b5', lightStyle: 'background:#fce8ed', borderStyle: 'border-color:#f8c5d1', textStyle: 'color:#9a1039' },
                green: { bgStyle: 'background:#1a1b1d', lightStyle: 'background:#f3f4f6', borderStyle: 'border-color:#d1d5db', textStyle: 'color:#1a1b1d' }
            };

            let html = `
                <div class="space-y-6">
                    <div class="p-4 rounded-xl border" style="background: linear-gradient(135deg, #fce8ed, #fff); border-color: #f8c5d1;">
                        <h2 class="text-xl font-bold mb-2" style="color: #d5164d;">Convention Schedule</h2>
                        <p class="text-sm text-slate-600">
                            <strong>Venue:</strong> ${eventInfo.venue}<br>
                            <strong>Address:</strong> ${eventInfo.venueAddress}
                        </p>
                        <p class="text-xs text-slate-500 mt-2">Saturday Feb 14 & Sunday Feb 15, 2026</p>
                    </div>

                    <!-- Add to Calendar Buttons by Age Group -->
                    <div class="glass-card rounded-xl p-4">
                        <h3 class="font-bold text-slate-800 mb-2">üìÖ Add Full Schedule to Calendar</h3>
                        <p class="text-xs text-slate-500 mb-3">Downloads a calendar file with each class as a separate event. Import into Google Calendar, Apple Calendar, or Outlook.</p>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                            <button onclick="generateICSFile('teensSeniors')"
                               class="flex items-center justify-center gap-2 text-white px-4 py-3 rounded-lg font-semibold transition-colors cursor-pointer hover:opacity-90" style="background: #d5164d;">
                                <span>üìÜ</span>
                                <span>Teens/Seniors<br><span class="text-xs font-normal opacity-90">Ages 13 & Up</span></span>
                            </button>
                            <button onclick="generateICSFile('juniors')"
                               class="flex items-center justify-center gap-2 text-white px-4 py-3 rounded-lg font-semibold transition-colors cursor-pointer hover:opacity-90" style="background: #e8708d;">
                                <span>üìÜ</span>
                                <span>Juniors<br><span class="text-xs font-normal opacity-90">Ages 9-12</span></span>
                            </button>
                            <button onclick="generateICSFile('minis')"
                               class="flex items-center justify-center gap-2 text-white px-4 py-3 rounded-lg font-semibold transition-colors cursor-pointer hover:opacity-90" style="background: #f1a3b5;">
                                <span>üìÜ</span>
                                <span>Minis<br><span class="text-xs font-normal opacity-90">Ages 6-8</span></span>
                            </button>
                        </div>
                        <button onclick="generateICSFile('parents')"
                           class="mt-3 w-full flex items-center justify-center gap-2 text-white px-4 py-2 rounded-lg font-semibold transition-colors text-sm cursor-pointer hover:opacity-90" style="background: #1a1b1d;">
                            <span>üìÜ</span>
                            <span>Teachers & Parents Schedule</span>
                        </button>
                    </div>
            `;

            // Render each age group as collapsible accordion
            Object.entries(conventionByAgeGroup).forEach(([groupKey, group]) => {
                const colors = colorMap[group.color] || colorMap.pink;
                const isExpanded = state.expandedGroups[groupKey] || false;

                html += `
                    <div class="glass-card rounded-xl overflow-hidden">
                        <button onclick="toggleScheduleGroup('${groupKey}')" class="text-white px-4 py-3 w-full text-left cursor-pointer hover:opacity-95 transition-opacity" style="${colors.bgStyle}">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h3 class="font-bold text-lg">${group.name}</h3>
                                    <p class="text-sm opacity-90">${group.ages}${group.ages ? ' ‚Ä¢ ' : ''}${group.room}</p>
                                </div>
                                <svg id="schedule-arrow-${groupKey}" class="w-6 h-6 transition-transform duration-300" style="transform: rotate(${isExpanded ? '180' : '0'}deg)" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                        </button>

                        <div id="schedule-content-${groupKey}" class="overflow-hidden transition-all duration-300" style="max-height: ${isExpanded ? 'none' : '0'}">
                            <!-- Saturday -->
                            <div class="px-4 py-2 border-b" style="${colors.lightStyle}; ${colors.borderStyle}">
                                <h4 class="font-semibold" style="${colors.textStyle}">Saturday, Feb 14</h4>
                            </div>
                            <div class="divide-y divide-slate-100">
                `;

                group.saturday.forEach(cls => {
                    const isBreak = cls.isBreak;
                    const escapedName = cls.name.replace(/'/g, "\\'");
                    const escapedNote = cls.note ? cls.note.replace(/'/g, "\\'") : '';
                    const fullTitle = cls.note ? `${cls.name} (${cls.note})` : cls.name;
                    const escapedFullTitle = fullTitle.replace(/'/g, "\\'");
                    html += `
                        <div class="p-3 flex items-center hover:bg-slate-50 ${isBreak ? 'bg-slate-50' : ''}">
                            <div class="flex-grow">
                                <div class="flex items-center gap-2">
                                    <span class="font-mono text-sm font-semibold" style="${colors.textStyle}">${cls.time}${cls.end && cls.end !== cls.time ? ' - ' + cls.end : ''}</span>
                                </div>
                                <div class="font-medium text-slate-800 ${isBreak ? 'text-slate-500 italic' : ''}">${cls.name}</div>
                                ${cls.note ? `<div class="text-xs text-slate-500">${cls.note}</div>` : ''}
                            </div>
                            ${!isBreak ? `
                            <button onclick="event.stopPropagation(); addSingleEventToCalendar('${escapedFullTitle}', '2026-02-14', '${cls.time}', '${cls.end}', '${group.room}')"
                                class="add-cal-btn ml-2 px-2 py-1 flex items-center justify-center rounded text-xs font-medium whitespace-nowrap" title="Add to Google Calendar">
                                + Add to Calendar
                            </button>
                            ` : ''}
                        </div>
                    `;
                });

                html += `
                            </div>

                            <!-- Sunday -->
                            <div class="px-4 py-2 border-b border-t" style="${colors.lightStyle}; ${colors.borderStyle}">
                                <h4 class="font-semibold" style="${colors.textStyle}">Sunday, Feb 15</h4>
                            </div>
                            <div class="divide-y divide-slate-100">
                `;

                group.sunday.forEach(cls => {
                    const isBreak = cls.isBreak;
                    const escapedName = cls.name.replace(/'/g, "\\'");
                    const escapedNote = cls.note ? cls.note.replace(/'/g, "\\'") : '';
                    const fullTitle = cls.note ? `${cls.name} (${cls.note})` : cls.name;
                    const escapedFullTitle = fullTitle.replace(/'/g, "\\'");
                    html += `
                        <div class="p-3 flex items-center hover:bg-slate-50 ${isBreak ? 'bg-slate-50' : ''}">
                            <div class="flex-grow">
                                <div class="flex items-center gap-2">
                                    <span class="font-mono text-sm font-semibold" style="${colors.textStyle}">${cls.time}${cls.end && cls.end !== cls.time ? ' - ' + cls.end : ''}</span>
                                </div>
                                <div class="font-medium text-slate-800 ${isBreak ? 'text-slate-500 italic' : ''}">${cls.name}</div>
                                ${cls.note ? `<div class="text-xs text-slate-500">${cls.note}</div>` : ''}
                            </div>
                            ${!isBreak ? `
                            <button onclick="event.stopPropagation(); addSingleEventToCalendar('${escapedFullTitle}', '2026-02-15', '${cls.time}', '${cls.end}', '${group.room}')"
                                class="add-cal-btn ml-2 px-2 py-1 flex items-center justify-center rounded text-xs font-medium whitespace-nowrap" title="Add to Google Calendar">
                                + Add to Calendar
                            </button>
                            ` : ''}
                        </div>
                    `;
                });

                html += `
                            </div>
                        </div>
                    </div>
                `;
            });

            html += `</div>`;
            container.innerHTML = html;
        }

        // --- Render Dance Order ---
        function renderDanceOrder(container) {
            let html = `
                <div class="space-y-4">
                    <!-- Side by side header boxes -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <div class="p-3 rounded-xl border" style="background: linear-gradient(135deg, #fce8ed, #fff); border-color: #f8c5d1;">
                            <h2 class="text-lg font-bold" style="color: #d5164d;">Competition Dance Order</h2>
                            <p class="text-xs text-slate-600">Friday, February 13, 2026</p>
                        </div>

                        <div class="glass-card rounded-xl p-3">
                            <h3 class="font-bold text-slate-800 text-sm mb-2">üìÖ Add to Calendar</h3>
                            <button onclick="generateDanceOrderICS()"
                                class="flex items-center justify-center gap-2 text-white px-3 py-2 rounded-lg font-semibold text-sm transition-colors hover:opacity-90 w-full" style="background: #d5164d;">
                                <span>üìÜ</span>
                                <span>Download All (${danceOrder.filter(d => !d.isAwards).length} dances)</span>
                            </button>
                            <p class="text-xs text-slate-500 mt-2">Or tap <span class="add-cal-btn inline-flex items-center justify-center px-1 py-0.5 rounded text-xs font-medium">+ Cal</span> next to any dance</p>
                        </div>
                    </div>

                    <!-- ICS Instructions (collapsible) -->
                    <details class="glass-card rounded-xl">
                        <summary class="p-3 cursor-pointer text-sm font-medium text-slate-700 hover:bg-slate-50">
                            ‚ÑπÔ∏è How to use the .ics calendar file
                        </summary>
                        <div class="px-3 pb-3 text-xs text-slate-600 space-y-1">
                            <p><strong>iPhone/iPad:</strong> Tap the downloaded file, then tap "Add All"</p>
                            <p><strong>Android:</strong> Open the file and select your calendar app</p>
                            <p><strong>Google Calendar:</strong> Go to calendar.google.com ‚Üí Settings ‚Üí Import & Export ‚Üí Import</p>
                            <p><strong>Outlook:</strong> Double-click the file or drag it into your calendar</p>
                        </div>
                    </details>

                    <div class="glass-card rounded-xl overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-slate-100">
                                    <tr>
                                        <th class="px-2 py-3 text-left text-xs font-semibold text-slate-600 w-8"></th>
                                        <th class="px-2 py-3 text-left text-xs font-semibold text-slate-600">#</th>
                                        <th class="px-2 py-3 text-left text-xs font-semibold text-slate-600">Time</th>
                                        <th class="px-2 py-3 text-left text-xs font-semibold text-slate-600">Routine</th>
                                        <th class="px-2 py-3 text-left text-xs font-semibold text-slate-600">Dancer</th>
                                        <th class="px-2 py-3 text-left text-xs font-semibold text-slate-600 hidden sm:table-cell">Division</th>
                                        <th class="px-2 py-3 text-left text-xs font-semibold text-slate-600 hidden sm:table-cell">Type</th>
                                    </tr>
                                </thead>
                                <tbody>
            `;

            danceOrder.forEach(dance => {
                const isAwards = dance.isAwards;
                const rowClass = isAwards
                    ? 'bg-violet-100 font-semibold'
                    : dance.dancer ? 'bg-white hover:bg-slate-50' : 'bg-slate-50 hover:bg-slate-100';

                const divisionClass = dance.division ? `division-${dance.division.toLowerCase().replace('/', '-')}` : '';
                const typeClass = dance.type ? `type-${dance.type.toLowerCase()}` : '';

                const escapedName = dance.name.replace(/'/g, "\\'");
                const escapedDancer = dance.dancer ? dance.dancer.replace(/'/g, "\\'") : '';
                const escapedDivision = dance.division ? dance.division.replace(/'/g, "\\'") : '';
                const escapedStyle = dance.style ? dance.style.replace(/'/g, "\\'") : '';
                const escapedType = dance.type ? dance.type.replace(/'/g, "\\'") : '';

                html += `
                    <tr class="${rowClass} border-b border-slate-100">
                        <td class="px-2 py-2">
                            ${!isAwards ? `
                            <button onclick="addDanceToCalendar('${escapedName}', '${escapedDancer}', '${dance.time}', '${escapedDivision}', '${escapedStyle}', '${escapedType}', ${dance.num || 'null'})"
                                class="add-cal-btn px-2 py-1 flex items-center justify-center rounded text-xs font-medium whitespace-nowrap" title="Add to Google Calendar">
                                + Cal
                            </button>
                            ` : ''}
                        </td>
                        <td class="px-2 py-2 text-slate-500 font-mono text-xs">${dance.num || '-'}</td>
                        <td class="px-2 py-2 text-violet-600 font-mono font-semibold text-xs">${dance.time}</td>
                        <td class="px-2 py-2 text-slate-800 font-medium">${dance.name}</td>
                        <td class="px-2 py-2 ${dance.dancer ? 'text-slate-800 font-semibold' : 'text-slate-400'}">${dance.dancer || '-'}</td>
                        <td class="px-2 py-2 hidden sm:table-cell">${dance.division ? `<span class="text-xs px-2 py-1 rounded ${divisionClass}">${dance.division}</span>` : '-'}</td>
                        <td class="px-2 py-2 hidden sm:table-cell">${dance.type && !isAwards ? `<span class="text-xs px-2 py-1 rounded ${typeClass}">${dance.type}</span>` : isAwards ? 'üèÜ' : '-'}</td>
                    </tr>
                `;
            });

            html += `
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs">
                        <div class="flex items-center gap-2"><span class="w-3 h-3 rounded division-junior"></span> Junior</div>
                        <div class="flex items-center gap-2"><span class="w-3 h-3 rounded division-preteen"></span> PreTeen</div>
                        <div class="flex items-center gap-2"><span class="w-3 h-3 rounded division-teen"></span> Teen</div>
                        <div class="flex items-center gap-2"><span class="w-3 h-3 rounded division-senior"></span> Senior</div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        // --- Render Food ---
        function renderFood(container) {
            let html = `
                <div class="space-y-6">
                    <div class="p-4 rounded-xl border" style="background: linear-gradient(135deg, #fce8ed, #fff); border-color: #f8c5d1;">
                        <h2 class="text-xl font-bold mb-2" style="color: #d5164d;">Places to Eat</h2>
                        <p class="text-sm text-slate-600">Near ${eventInfo.venue}</p>
                    </div>

                    <!-- Map -->
                    <div class="glass-card rounded-xl overflow-hidden">
                        <div class="p-3 bg-slate-50 border-b border-slate-200">
                            <h3 class="font-semibold text-slate-700">üìç Area Map</h3>
                        </div>
                        <div id="food-map" class="h-64 w-full"></div>
                    </div>

                    <!-- Walkable Restaurants -->
                    <div class="glass-card rounded-xl overflow-hidden">
                        <div class="p-4 bg-green-50 border-b border-green-100">
                            <h3 class="font-bold text-green-800">üö∂ Walking Distance</h3>
                        </div>
                        <div class="divide-y divide-slate-100">
            `;

            placesToEat.walkable.forEach(place => {
                const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(place.name + ' ' + place.address)}`;
                html += `
                    <div class="p-4 hover:bg-slate-50">
                        <div class="flex justify-between items-start gap-3">
                            <div class="flex-grow">
                                <a href="${mapsUrl}" target="_blank" class="font-semibold text-slate-800 hover:text-violet-600 transition-colors">${place.name}</a>
                                <div class="text-sm text-slate-500">${place.type} ‚Ä¢ ${place.price}</div>
                                <div class="text-xs text-slate-400 mt-1">${place.address}</div>
                                ${place.note ? `<div class="text-xs text-green-600 mt-1">${place.note}</div>` : ''}
                                <div class="flex gap-2 mt-2">
                                    <a href="${mapsUrl}" target="_blank" class="inline-flex items-center gap-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                        Directions
                                    </a>
                                    ${place.menu ? `<a href="${place.menu}" target="_blank" class="inline-flex items-center gap-1 text-xs bg-green-100 hover:bg-green-200 text-green-700 px-2 py-1 rounded transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                                        Menu
                                    </a>` : ''}
                                    ${place.website ? `<a href="${place.website}" target="_blank" class="inline-flex items-center gap-1 text-xs bg-slate-100 hover:bg-slate-200 text-slate-700 px-2 py-1 rounded transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path></svg>
                                        Website
                                    </a>` : ''}
                                </div>
                            </div>
                            <span class="text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded-full whitespace-nowrap">${place.distance}</span>
                        </div>
                    </div>
                `;
            });

            html += `
                        </div>
                    </div>

                    <!-- Delivery Options -->
                    <div class="glass-card rounded-xl overflow-hidden">
                        <div class="p-4 bg-orange-50 border-b border-orange-100">
                            <h3 class="font-bold text-orange-800">üöó Delivery Options</h3>
                        </div>
                        <div class="divide-y divide-slate-100">
            `;

            placesToEat.delivery.forEach(place => {
                html += `
                    <div class="p-4 hover:bg-slate-50">
                        <div class="flex flex-col sm:flex-row justify-between items-start gap-2">
                            <div class="flex-grow">
                                ${place.website ? `<a href="${place.website}" target="_blank" class="font-semibold text-slate-800 hover:text-violet-600 transition-colors">${place.name}</a>` : `<div class="font-semibold text-slate-800">${place.name}</div>`}
                                <div class="text-sm text-slate-500">${place.type}</div>
                                <div class="flex gap-2 mt-2">
                                    ${place.menu ? `<a href="${place.menu}" target="_blank" class="inline-flex items-center gap-1 text-xs bg-green-100 hover:bg-green-200 text-green-700 px-2 py-1 rounded transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                                        Menu / Order
                                    </a>` : ''}
                                    ${place.website && !place.menu ? `<a href="${place.website}" target="_blank" class="inline-flex items-center gap-1 text-xs bg-slate-100 hover:bg-slate-200 text-slate-700 px-2 py-1 rounded transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path></svg>
                                        Website
                                    </a>` : ''}
                                </div>
                            </div>
                            <div class="flex flex-wrap gap-1 justify-end">
                                ${place.apps.map(app => `<span class="text-xs bg-orange-100 text-orange-700 px-2 py-0.5 rounded">${app}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                `;
            });

            html += `
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
            initFoodMap();
        }

        let foodMapInstance = null;

        function initFoodMap() {
            if (foodMapInstance) {
                foodMapInstance.remove();
                foodMapInstance = null;
            }

            const mapContainer = document.getElementById('food-map');
            if (!mapContainer) return;

            foodMapInstance = L.map('food-map').setView([eventInfo.venueLat, eventInfo.venueLng], 15);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap'
            }).addTo(foodMapInstance);

            // Hotel marker
            const hotelIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div style="background: #7c3aed; color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); border: 3px solid white;">üè®</div>`,
                iconSize: [36, 36],
                iconAnchor: [18, 18]
            });

            L.marker([eventInfo.venueLat, eventInfo.venueLng], { icon: hotelIcon })
                .addTo(foodMapInstance)
                .bindPopup(`<strong>${eventInfo.venue}</strong><br>${eventInfo.venueAddress}`);

            // Restaurant markers
            placesToEat.walkable.forEach(place => {
                const icon = L.divIcon({
                    className: 'custom-marker',
                    html: `<div style="background: #22c55e; color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; box-shadow: 0 2px 6px rgba(0,0,0,0.3); border: 2px solid white;">üçΩÔ∏è</div>`,
                    iconSize: [28, 28],
                    iconAnchor: [14, 14]
                });

                L.marker([place.lat, place.lng], { icon })
                    .addTo(foodMapInstance)
                    .bindPopup(`<strong>${place.name}</strong><br>${place.type} ‚Ä¢ ${place.price}<br><em>${place.distance}</em>`);
            });
        }

        // --- Render Activities ---
        function renderActivities(container) {
            let html = `
                <div class="space-y-6">
                    <div class="p-4 rounded-xl border" style="background: linear-gradient(135deg, #fce8ed, #fff); border-color: #f8c5d1;">
                        <h2 class="text-xl font-bold mb-2" style="color: #d5164d;">Things to Do Nearby</h2>
                        <p class="text-sm text-slate-600">Attractions and activities near the hotel</p>
                    </div>

                    <!-- Map -->
                    <div class="glass-card rounded-xl overflow-hidden">
                        <div class="p-3 bg-slate-50 border-b border-slate-200">
                            <h3 class="font-semibold text-slate-700">üìç Attractions Map</h3>
                        </div>
                        <div id="activities-map" class="h-72 w-full"></div>
                    </div>

                    <!-- Activities List -->
                    <div class="grid gap-4">
            `;

            nearbyActivities.forEach(activity => {
                const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(activity.name + ' ' + activity.address)}`;
                html += `
                    <div class="glass-card rounded-xl p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-start gap-4">
                            <div class="text-3xl">${activity.icon}</div>
                            <div class="flex-grow">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <a href="${mapsUrl}" target="_blank" class="font-bold text-slate-800 hover:text-pink-600 transition-colors">${activity.name}</a>
                                        <div class="text-sm" style="color: #d5164d;">${activity.type}</div>
                                    </div>
                                    <span class="text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded-full whitespace-nowrap">${activity.distance}</span>
                                </div>
                                <p class="text-sm text-slate-600 mt-2">${activity.note}</p>
                                <p class="text-xs text-slate-400 mt-1">${activity.address}</p>
                                <div class="flex gap-2 mt-3">
                                    <a href="${mapsUrl}" target="_blank" class="inline-flex items-center gap-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                        Directions
                                    </a>
                                    ${activity.website ? `<a href="${activity.website}" target="_blank" class="inline-flex items-center gap-1 text-xs bg-slate-100 hover:bg-slate-200 text-slate-700 px-2 py-1 rounded transition-colors">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path></svg>
                                        Website
                                    </a>` : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            html += `</div></div>`;
            container.innerHTML = html;
            initActivitiesMap();
        }

        let activitiesMapInstance = null;

        function initActivitiesMap() {
            if (activitiesMapInstance) {
                activitiesMapInstance.remove();
                activitiesMapInstance = null;
            }

            const mapContainer = document.getElementById('activities-map');
            if (!mapContainer) return;

            activitiesMapInstance = L.map('activities-map').setView([eventInfo.venueLat, eventInfo.venueLng], 13);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap'
            }).addTo(activitiesMapInstance);

            // Hotel marker
            const hotelIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div style="background: #7c3aed; color: white; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); border: 3px solid white;">üè®</div>`,
                iconSize: [36, 36],
                iconAnchor: [18, 18]
            });

            L.marker([eventInfo.venueLat, eventInfo.venueLng], { icon: hotelIcon })
                .addTo(activitiesMapInstance)
                .bindPopup(`<strong>${eventInfo.venue}</strong><br>Home Base`);

            // Activity markers
            nearbyActivities.forEach(activity => {
                const icon = L.divIcon({
                    className: 'custom-marker',
                    html: `<div style="background: #f59e0b; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 16px; box-shadow: 0 2px 6px rgba(0,0,0,0.3); border: 2px solid white;">${activity.icon}</div>`,
                    iconSize: [32, 32],
                    iconAnchor: [16, 16]
                });

                L.marker([activity.lat, activity.lng], { icon })
                    .addTo(activitiesMapInstance)
                    .bindPopup(`<strong>${activity.name}</strong><br>${activity.note}<br><em>${activity.distance} from hotel</em>`);
            });
        }

        // --- Render Feedback/Suggestions ---
        function renderFeedback(container) {
            let html = `
                <div class="space-y-6">
                    <div class="p-4 rounded-xl border" style="background: linear-gradient(135deg, #fce8ed, #fff); border-color: #f8c5d1;">
                        <h2 class="text-xl font-bold mb-2" style="color: #d5164d;">Suggest Updates</h2>
                        <p class="text-sm text-slate-600">Help us keep this info accurate! Submit corrections or suggestions below.</p>
                    </div>

                    <div class="glass-card rounded-xl p-4">
                        <h3 class="font-bold text-slate-800 mb-3">üìù What can you suggest?</h3>
                        <ul class="text-sm text-slate-600 space-y-2 mb-4">
                            <li>‚Ä¢ <strong>Dance corrections:</strong> Wrong time, dancer name, or category</li>
                            <li>‚Ä¢ <strong>Restaurant recommendations:</strong> Great places to eat nearby</li>
                            <li>‚Ä¢ <strong>Activity suggestions:</strong> Fun things to do in the area</li>
                            <li>‚Ä¢ <strong>Schedule updates:</strong> Changes to convention times</li>
                            <li>‚Ä¢ <strong>Any other info</strong> that would help the team!</li>
                        </ul>
                    </div>

                    <!-- Google Form Embed -->
                    <div class="glass-card rounded-xl overflow-hidden">
                        <div class="p-4 border-b" style="background: #fce8ed; border-color: #f8c5d1;">
                            <h3 class="font-bold" style="color: #d5164d;">Submit Your Suggestion</h3>
                        </div>
                        <div class="p-4">
                            <iframe
                                src="https://docs.google.com/forms/d/e/1FAIpQLSefWNQmR1zrbsQm2bZhKqnckJ7aAL-YDBaPKBkqjuaB26NAIQ/viewform?embedded=true"
                                width="100%"
                                height="600"
                                frameborder="0"
                                marginheight="0"
                                marginwidth="0"
                                class="rounded-lg"
                                style="min-height: 500px;">
                                Loading form...
                            </iframe>

                            <div class="mt-4 p-3 bg-slate-50 rounded-lg text-xs text-slate-500">
                                <strong>Note:</strong> Responses go directly to the team organizer. Your suggestions help keep everyone informed!
                            </div>
                        </div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

    </script>
</body>
</html>
